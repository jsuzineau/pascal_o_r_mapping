<!DOCTYPE html>
<html>
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <!-- <meta 
          http-equiv="Content-Security-Policy" 
          content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;"
          > -->
          <!-- content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *; img-src 'self' data: content:;" -->
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="initial-scale=1, width=device-width, viewport-fit=cover">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <title>Hello World</title>
        <script type="text/javascript" src="cordova.js"></script>
    </head>
    <body>
      <svg
         id="svg2"
         width="700"
         height="785"
         viewBox="0 0 700 785">
        <path
           style="fill:#000000"
           d="m 152.99353,763.06566 c -12.50641,-3.80428 -20.28021,-12.56054 -20.3546,-22.92705 -0.0488,-6.80578 1.76211,-10.56767 8.53423,-17.72818 l 4.92324,-5.2056 -2.96215,-2.10924 c -4.12182,-2.93499 -8.13962,-11.3754 -8.11229,-17.04193 0.0465,-9.65057 7.87609,-19.17512 18.513,-22.52084 8.12522,-2.55569 24.21015,-1.82488 30.46504,1.38417 8.58476,4.40438 12,9.07507 12,16.41123 0,5.54988 -1.77418,9.83954 -6.88006,16.63483 l -4.00862,5.33497 3.8413,2.78262 c 13.08229,9.47676 14.65388,26.15496 3.51428,37.29456 -6.60749,6.60749 -12.87588,8.64619 -26.25441,8.53885 -5.89187,-0.0473 -11.8404,-0.42905 -13.21896,-0.84839 z m 20.92716,-4.52465 c 6.48152,-3.35172 9.16441,-13.63658 5.22785,-20.04101 -1.22679,-1.99587 -5.97798,-5.34296 -14.19502,-10 -6.79307,-3.85 -12.88723,-7.13599 -13.54256,-7.30219 -1.54845,-0.39272 -7.93544,7.41987 -9.88975,12.09717 -2.14604,5.13621 -1.90169,8.5488 1.03392,14.43981 5.35174,10.73954 21.04143,16.14504 31.36556,10.80622 z m 8.38956,-50.06313 c 5.94393,-7.44944 7.38244,-16.18929 3.66752,-22.28245 -4.50866,-7.39506 -19.88541,-10.75029 -27.07989,-5.90887 -6.128,4.12375 -7.24982,13.15528 -2.22087,17.87974 2.07349,1.94794 20.80504,13.48306 22.32299,13.74678 0.275,0.0478 1.76461,-1.49806 3.31025,-3.4352 z M 155.5,660.06448 c -22.71775,-3.71667 -41.69039,-17.79406 -52.42085,-38.8954 -5.698374,-11.20579 -8.118227,-32.68357 -4.724171,-41.93006 3.987821,-10.86409 13.798491,-19.70937 25.956421,-23.40222 17.7479,-5.39076 33.99392,2.00377 42.09586,19.16034 2.68159,5.67848 3.06953,7.58042 3.06016,15.00286 -0.013,10.29459 -2.86442,17.44963 -9.66368,24.24889 -7.16302,7.16302 -12.56993,9.25148 -23.94529,9.24904 l -9.64155,-0.002 1.8258,2.5641 c 2.80887,3.94469 10.09801,10.35512 15.0204,13.20967 7.83605,4.54423 15.04661,6.02394 26.96207,5.53301 9.77405,-0.40271 11.33777,-0.75296 18.45786,-4.13427 17.25628,-8.19498 31.558,-29.67163 35.40585,-53.16838 1.56923,-9.58242 2.39636,-33.43087 1.61216,-46.48271 L 224.77899,529 H 112.8895 1 v -3.5 -3.5 l 76.75,-0.0134 76.75,-0.0134 -9.62494,-4.77133 C 117.71749,503.73919 95.425956,478.56214 83.382979,447.75 L 79.572175,438 H 40.286088 1 v -3.5 -3.5 h 38.608408 38.608408 l -0.541564,-2.25 c -2.284609,-9.4917 -3.052706,-17.52229 -3.084599,-32.25 -0.03858,-17.81449 0.904208,-24.48596 5.877802,-41.5933 L 82.76716,347 H 41.88358 1 v -3.5 -3.5 h 42.424891 42.424891 l 2.908991,-5.25 c 5.673584,-10.2394 14.585187,-25.3128 17.588617,-29.75 3.41286,-5.04209 20.01823,-25.68949 31.96835,-39.75 L 146.17738,256 H 73.588691 1 v -3.5 -3.5 h 75.809275 75.809275 l 4.63772,-5.37185 4.63772,-5.37185 -4.36587,-15.49013 c -5.44415,-19.31589 -9.29719,-36.38303 -10.87772,-48.18303 L 145.43378,165.5 73.21689,165.24342 1,164.98685 V 161.49342 158 l 71.75,7.9e-4 71.75,7.9e-4 -0.32714,-26.75079 c -0.35299,-28.86377 0.35003,-36.915729 4.4664,-51.156088 2.66686,-9.225847 9.49828,-24.457488 14.61564,-32.587688 C 174.69959,29.324264 193.37863,11 200.46872,11 c 3.0037,0 3.83819,0.77793 9.61615,8.964327 13.15682,18.641002 22.55884,37.957738 31.4114,64.535673 7.37499,22.14183 9.00373,31.95537 9.00373,54.24954 v 19.24955 l 71.75,4.5e-4 L 394,158 v 3.5 3.5 h -72.46146 -72.46145 l -1.07407,4.25 c -2.03875,8.06718 -7.18378,22.15887 -10.48091,28.70609 -3.94228,7.82834 -18.55758,30.06827 -27.79405,42.29391 L 203.11744,249 H 298.55872 394 v 3.5 3.5 h -98.38495 -98.38494 l -5.12302,6.25 c -3.11675,3.80239 -4.89614,6.83743 -4.54368,7.75 1.33205,3.44898 9.78475,33.82793 14.19032,51 l 4.74627,18.5 93.75,0.25513 93.75,0.25512 V 343.50513 347 l -74.25,0.0263 -74.25,0.0263 7,3.73403 c 10.57804,5.64269 15.27262,9.20498 23.5514,17.87103 8.7246,9.13273 12.30554,14.09619 17.2013,23.84232 4.6177,9.19258 7.46073,18.62094 8.92004,29.5816 l 1.18741,8.9184 H 348.68007 394 v 3.5 3.5 H 348.5 303 v 2.36901 c 0,1.30296 -0.68383,6.29036 -1.51961,11.08312 -5.30669,30.4308 -26.01552,55.42324 -56.48039,68.16331 l -5.5,2.30004 77.25,0.0423 L 394,522 v 3.5 3.5 h -77.15656 -77.15656 l 0.60652,15.25 c 0.80799,20.31596 -0.64141,45.05847 -3.23653,55.25 -7.18217,28.20579 -29.37742,52.63127 -53.59139,58.97638 -7.27559,1.90652 -21.18953,2.69666 -27.96548,1.5881 z m 56.62108,-148.12484 c 5.68314,-0.58321 10.46086,-1.18825 10.61715,-1.34454 0.73544,-0.73544 -6.79501,-52.3849 -9.81886,-67.3451 L 211.8582,438 h -26.94349 -26.9435 l 3.10995,6.16077 c 3.59069,7.11313 10.738,14.62745 19.66884,20.67885 5.44643,3.69042 6.25,4.63968 6.25,7.38319 0,4.27134 -3.42171,7.77719 -7.59054,7.77719 -8.65726,0 -30.21186,-19.7699 -37.00405,-33.94015 L 138.5421,438 h -18.89886 -18.89886 l 0.65681,4.10746 c 0.36125,2.25911 1.98675,7.54661 3.61224,11.75 7.4958,19.38366 24.72588,37.62496 45.78503,48.47211 18.56961,9.56484 35.6616,12.24338 61.32262,9.61007 z m 34.55598,-9.08308 c 10.36932,-5.84832 20.97151,-18.02585 26.42234,-30.34836 3.9095,-8.83809 6.10404,-25.41569 4.27031,-32.2582 L 276.76674,438 h -24.96283 -24.96282 l 0.57269,2.75 c 1.29215,6.20478 6.53986,39.68058 8.22922,52.49518 2.06132,15.6361 1.38951,15.05092 11.03406,9.61138 z M 135.91855,427.25 c -1.40696,-6.05865 -1.04593,-21.78117 0.6786,-29.55259 4.50153,-20.28578 18.47924,-37.77771 38.16724,-47.76308 l 5.73561,-2.909 -28.5,-0.006 -28.5,-0.006 -1.89134,3.24367 c -4.46173,7.65191 -9.64728,18.87215 -12.59096,27.24368 -6.34127,18.03396 -8.12055,26.23985 -8.7274,40.25 l -0.573928,13.25 h 18.536498 18.53651 l -0.87083,-3.75 z M 210,428.9788 c 0,-2.81482 -9.11337,-46.31801 -9.88474,-47.18536 -1.17421,-1.3203 -14.58701,2.41331 -21.39001,5.95416 -8.07567,4.20326 -15.43047,11.82248 -19.29247,19.98608 -2.08288,4.40283 -2.82599,7.75882 -3.21023,14.49767 L 155.72259,431 h 27.1387 C 209.4282,431 210,430.95741 210,428.9788 Z m 65,0.30854 c 0,-0.94197 -1.89565,-5.55447 -4.21257,-10.25 -3.36258,-6.81475 -6.03932,-10.39039 -13.26617,-17.72123 -7.5464,-7.65498 -10.46597,-9.86137 -17.53744,-13.25345 -6.83907,-3.28061 -22.64312,-7.7367 -23.69796,-6.68185 -0.23902,0.23902 8.52451,46.00895 9.26121,48.36919 0.29822,0.95543 6.17119,1.25 24.92155,1.25 C 272.96144,431 275,430.85768 275,429.28734 Z M 185.91526,321.25 c -2.70013,-10.3125 -6.17859,-23.43648 -7.72992,-29.16439 l -2.82059,-10.41439 -10.93238,12.29038 c -10.21307,11.48174 -35.33487,43.61894 -35.40215,45.2884 -0.0166,0.4125 13.88031,0.75 30.88207,0.75 h 30.91229 z m 4.18348,-118.25434 c 7.97768,-10.99912 22.83653,-35.18317 22.884,-37.24566 0.009,-0.4125 -11.73459,-0.75 -26.09796,-0.75 h -26.11523 l 0.69103,5.75 c 1.18733,9.87971 5.35995,30.11699 8.68458,42.12042 l 3.18886,11.51322 3.84765,-4.44182 c 2.11621,-2.443 7.92889,-10.06877 12.91707,-16.94616 z m 28.11597,-50.28135 c 6.24531,-16.82459 8.75167,-37.14632 6.91616,-56.076718 -1.0716,-11.05189 -5.00054,-30.840593 -6.40136,-32.241412 C 217.87935,63.546014 209.05149,68.38143 202,73.559686 188.59955,83.4003 177.97409,96.45384 170.4704,112.2943 c -5.83949,12.32728 -8.54711,22.7627 -9.20365,35.47175 l -0.53034,10.26605 27.85092,-0.26605 27.85093,-0.26605 z"
           id="path12" />
        <ellipse id="E3" cx="340" cy="523.94031" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('E3')" />
        <ellipse id="F3" cx="340" cy="478.89972" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('F3')" />
        <ellipse id="G3" cx="340" cy="436.33109" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('G3')" />
        <ellipse id="A3" cx="340" cy="392.22668" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('A3')" />
        <ellipse id="B3" cx="340" cy="345.17059" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('B3')" />
        <ellipse id="C3" cx="340" cy="607.32513" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('C3')" />
        <ellipse id="D3" cx="340" cy="565.92480" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('D3')" />
        <ellipse id="C4" cx="340" cy="302.81781" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('C4')" />
        <ellipse id="D4" cx="340" cy="249.73567" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('D4')" />
        <ellipse id="E4" cx="340" cy="201.49153" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('E4')" />
        <ellipse id="F4" cx="340" cy="158.48875" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('F4')" />
        <ellipse id="G4" cx="340" cy="116.18430" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('G4')" />
        <ellipse id="A4" cx="340" cy="73.143707" rx="24" ry="19.437899" style="stroke-width:0.6875" onclick="document.PlayNote('A4')" />
        <!-- <text x="300" y="500" fill="green" style="font-size:600px">&#119072;</text> -->
        <rect x="300" y="200"  width="500" height="4.5357141" style="stroke-width:0.26458332" fill="red"/>
        <rect x="300" y="295"  width="500" height="4.5357141" style="stroke-width:0.26458332" fill="red"/>
        <rect x="300" y="395"  width="500" height="4.5357141" style="stroke-width:0.26458332" fill="red"/>
      </svg>
      <script>
var ma = null;  // global MIDIAccess object
var midi_output = null;  

function onMIDISuccess( _MidiAccess)
  {
  console.log( "MIDI ready!" );
  ma = _MidiAccess;  // store in the global (in real usage, would probably keep in an object instance)
  listInputsAndOutputs();
  //sendMiddleC();
  //document.PlayNote( "C3#");
  _MidiAccess.onstatechange
  =
   function (e)
     {
     console.log(e.port.name + ' appears!');
     }
  }

function onMIDIFailure(msg) { alert( "Failed to get MIDI access - " + msg ); }
function listInputsAndOutputs()
  {
  console.log( "listInputsAndOutputs: ma=");
  console.log(ma);
  if (null=== ma) return;
  for (var entry of ma.inputs)
    {
    var input = entry[1];
    console.log(  "Input port [type:'" + input.type + "'] id:'" + input.id
                 +"' manufacturer:'" + input.manufacturer + "' name:'" + input.name
                 +"' version:'" + input.version + "'" );
    }

  for (var entry of ma.outputs)
    {
    var output = entry[1];
    console.log(  "Output port [type:'" + output.type + "'] id:'" + output.id
                 +"' manufacturer:'" + output.manufacturer + "' name:'" + output.name
                 +"' version:'" + output.version + "'" );
    midi_output= output;
    }
  }
function sendMiddleC() 
  {
  if (null===midi_output) return;
  var noteOnMessage = [0x90, 60, 0x7f];    // note on, middle C, full velocity
  midi_output.send( noteOnMessage );  //omitting the timestamp means send immediately.
  midi_output.send( [0x80, 60, 0x40], window.performance.now() + 1000.0 ); // Inlined array creation- note off, middle C,
                                                                           // release velocity = 64, timestamp = now + 1000ms.
  }
function Base_from_Octave(_Octave)
  {
  var Result = 0;
  switch( _Octave)
   {
   case "-1": Result=   0; break;
   case  "0": Result=  12; break;
   case  "1": Result=  24; break;
   case  "2": Result=  36; break;
   case  "3": Result=  48; break;
   case  "4": Result=  60; break;
   case  "5": Result=  72; break;
   case  "6": Result=  84; break;
   case  "7": Result=  96; break;
   case  "8": Result= 108; break;
   default  : Result =  0; break;
   };
  return Result;
  }
function Offset_from_Note(_Note)
  {
  var Result = 0;
  switch( _Note)
    {
    case "C": Result=  0; break;
    case "D": Result=  2; break;
    case "E": Result=  4; break;
    case "F": Result=  5; break;
    case "G": Result=  7; break;
    case "A": Result=  9; break;
    case "B": Result= 11; break;
    default : Result=  0; break;
    };
  return Result;
  }
function DieseBemol( _c)
  {
  switch( _c)
    {
    case "#": Result= +1; break;
    case "b": Result= -1; break;
    default : Result=  0; break;
    }
  return Result;
  }
function Midi_from_note(_note)
  {
  var Result= 0;
  var Note  = _note.charAt(0);
  var Octave= _note.charAt(1);
  var truc  = _note.charAt(2);
  Result
  =
      Base_from_Octave(Octave)
   +Offset_from_Note  (Note)
   +DieseBemol        (truc);
  return Result;
  };
document.PlayNote= function ( _Note)
  {
  console.log( "PlayNote:"+_Note);  
  if (undefined === _Note) return;
  if (null===midi_output) 
    {
    listInputsAndOutputs();  
    if (null===midi_output) return;
    }
  console.log( _Note);
  var MidiNote= Midi_from_note( _Note);
  var noteOnMessage = [0x90, MidiNote, 0x7f];    // note on, MidiNote, full velocity
  console.log( noteOnMessage);
  midi_output.send( noteOnMessage );  //omitting the timestamp means send immediately.
  //midi_output.send( [0x80, MidiNote, 0x40], window.performance.now() + 1000.0 ); // Inlined array creation- note off, middle C,
                                                                           // release velocity = 64, timestamp = now + 1000ms.
  };

navigator.requestMIDIAccess().then( onMIDISuccess, onMIDIFailure);

      </script>  
    </body>
</html>
